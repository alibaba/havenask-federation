/*
 * Copyright (c) 2021, Alibaba Group;
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *    http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

package org.havenask.engine.index.config;

import org.havenask.test.HavenaskTestCase;

public class EntryTableTests extends HavenaskTestCase {
    // test for EntryTable
    public void testEntryTable() {
        EntryTable entryTable = new EntryTable();
        assertEquals(entryTable.toString(), "{\"files\":{},\"package_files\":{}}");
    }

    // test for EntryTable.parse
    public void testEntryTableParse() {
        EntryTable entryTable = EntryTable.parse("{}");
        assertEquals(entryTable.toString(), "{\"files\":{},\"package_files\":{}}");
    }

    // test for EntryTable with files
    public void testEntryTableWithFiles() {
        String content = "{\"files\":{\"\":{\"index_format_version\":{\"length\":82},"
            + "\"index_partition_meta\":{\"length\":28},\"schema.json\":{\"length\":2335},"
            + "\"segment_0_level_0\":{\"length\":-2},\"segment_0_level_0/attribute\":{\"length\":-2},"
            + "\"segment_0_level_0/attribute/_id\":{\"length\":-2},"
            + "\"segment_0_level_0/attribute/_id/data\":{\"length\":1050},"
            + "\"segment_0_level_0/counter\":{\"length\":0},\"segment_0_level_0/deletionmap\":{\"length\":-2},"
            + "\"segment_0_level_0/segment_info\":{\"length\":347},"
            + "\"segment_0_level_0/segment_metrics\":{\"length\":52},"
            + "\"segment_0_level_0/summary\":{\"length\":-2},"
            + "\"segment_0_level_0/summary/data\":{\"length\":1400},"
            + "\"segment_0_level_0/summary/offset\":{\"length\":400},\"truncate_meta\":{\"length\":-2},"
            + "\"truncate_meta/index.mapper\":{\"length\":41},\"version.1\":{\"length\":1371}}},\"package_files\":{}}";
        EntryTable entryTable = EntryTable.parse(content);
        assertEquals(entryTable.toString(), content);
    }

    public void testEntryTableWithMoreFiles() {
        String content = "{\"files\":{\"\":{\"segment_536870928_level_0\":{\"length\":-2},"
            + "\"segment_536870928_level_0/attribute\":{\"length\":-2},"
            + "\"segment_536870928_level_0/attribute/_id\":{\"length\":-2},"
            + "\"segment_536870928_level_0/attribute/_id/data\":{\"length\":210},"
            + "\"segment_536870928_level_0/attribute/_id/data_info\":{\"length\":72},"
            + "\"segment_536870928_level_0/attribute/_id/offset\":{\"length\":44},"
            + "\"segment_536870928_level_0/attribute/_primary_term\":{\"length\":-2},"
            + "\"segment_536870928_level_0/attribute/_primary_term/data\":{\"length\":80},"
            + "\"segment_536870928_level_0/attribute/_seq_no\":{\"length\":-2},"
            + "\"segment_536870928_level_0/attribute/_seq_no/data\":{\"length\":80},"
            + "\"segment_536870928_level_0/attribute/_version\":{\"length\":-2},"
            + "\"segment_536870928_level_0/attribute/_version/data\":{\"length\":80},"
            + "\"segment_536870928_level_0/attribute/foo_test\":{\"length\":-2},"
            + "\"segment_536870928_level_0/attribute/foo_test/data\":{\"length\":10},"
            + "\"segment_536870928_level_0/attribute/foo_test/data_info\":{\"length\":71},"
            + "\"segment_536870928_level_0/attribute/foo_test/offset\":{\"length\":44},"
            + "\"segment_536870928_level_0/deletionmap\":{\"length\":-2},"
            + "\"segment_536870928_level_0/index\":{\"length\":-2},"
            + "\"segment_536870928_level_0/index/_id\":{\"length\":-2},"
            + "\"segment_536870928_level_0/index/_id/attribute__id\":{\"length\":-2},"
            + "\"segment_536870928_level_0/index/_id/attribute__id/data\":{\"length\":80},"
            + "\"segment_536870928_level_0/index/_id/data\":{\"length\":120},"
            + "\"segment_536870928_level_0/index/_routing\":{\"length\":-2},"
            + "\"segment_536870928_level_0/index/_routing/dictionary\":{\"length\":8},"
            + "\"segment_536870928_level_0/index/_routing/index_format_option\":{\"length\":725},"
            + "\"segment_536870928_level_0/index/_routing/posting\":{\"length\":0},"
            + "\"segment_536870928_level_0/index/_seq_no\":{\"length\":-2},"
            + "\"segment_536870928_level_0/index/_seq_no/dictionary\":{\"length\":176},"
            + "\"segment_536870928_level_0/index/_seq_no/index_format_option\":{\"length\":725},"
            + "\"segment_536870928_level_0/index/_seq_no/posting\":{\"length\":0},"
            + "\"segment_536870928_level_0/index/foo_test\":{\"length\":-2},"
            + "\"segment_536870928_level_0/index/foo_test/dictionary\":{\"length\":8},"
            + "\"segment_536870928_level_0/index/foo_test/index_format_option\":{\"length\":725},"
            + "\"segment_536870928_level_0/index/foo_test/posting\":{\"length\":0},"
            + "\"segment_536870928_level_0/normal_tablet_virtual_attribute\":{\"length\":-2},"
            + "\"segment_536870928_level_0/normal_tablet_virtual_attribute/virtual_concurrent_idx_name"
            + "\":{\"length\":-2},\"segment_536870928_level_0/normal_tablet_virtual_attribute"
            + "/virtual_concurrent_idx_name/data\":{\"length\":40},"
            + "\"segment_536870928_level_0/normal_tablet_virtual_attribute/virtual_hash_id_field_name\":{\"length"
            + "\":-2},\"segment_536870928_level_0/normal_tablet_virtual_attribute/virtual_hash_id_field_name"
            + "/data\":{\"length\":20},\"segment_536870928_level_0/normal_tablet_virtual_attribute"
            + "/virtual_timestamp_field_name\":{\"length\":-2},"
            + "\"segment_536870928_level_0/normal_tablet_virtual_attribute/virtual_timestamp_field_name/data"
            + "\":{\"length\":80},\"segment_536870928_level_0/operation_log\":{\"length\":-2},"
            + "\"segment_536870928_level_0/operation_log/data\":{\"length\":183},"
            + "\"segment_536870928_level_0/operation_log/meta\":{\"length\":595},"
            + "\"segment_536870928_level_0/operation_log/operation_field_info.0\":{\"length\":302},"
            + "\"segment_536870928_level_0/segment_info\":{\"length\":363},"
            + "\"segment_536870928_level_0/segment_metrics\":{\"length\":109},"
            + "\"segment_536870928_level_0/summary\":{\"length\":-2},"
            + "\"segment_536870928_level_0/summary/data\":{\"length\":280},"
            + "\"segment_536870928_level_0/summary/offset\":{\"length\":80},"
            + "\"segment_536870929_level_0\":{\"length\":-2},"
            + "\"segment_536870929_level_0/attribute\":{\"length\":-2},"
            + "\"segment_536870929_level_0/attribute/_id\":{\"length\":-2},"
            + "\"segment_536870929_level_0/attribute/_id/data\":{\"length\":210},"
            + "\"segment_536870929_level_0/attribute/_id/data_info\":{\"length\":72},"
            + "\"segment_536870929_level_0/attribute/_id/offset\":{\"length\":44},"
            + "\"segment_536870929_level_0/attribute/_primary_term\":{\"length\":-2},"
            + "\"segment_536870929_level_0/attribute/_primary_term/data\":{\"length\":80},"
            + "\"segment_536870929_level_0/attribute/_seq_no\":{\"length\":-2},"
            + "\"segment_536870929_level_0/attribute/_seq_no/data\":{\"length\":80},"
            + "\"segment_536870929_level_0/attribute/_version\":{\"length\":-2},"
            + "\"segment_536870929_level_0/attribute/_version/data\":{\"length\":80},"
            + "\"segment_536870929_level_0/attribute/foo_test\":{\"length\":-2},"
            + "\"segment_536870929_level_0/attribute/foo_test/data\":{\"length\":10},"
            + "\"segment_536870929_level_0/attribute/foo_test/data_info\":{\"length\":71},"
            + "\"segment_536870929_level_0/attribute/foo_test/offset\":{\"length\":44},"
            + "\"segment_536870929_level_0/deletionmap\":{\"length\":-2},"
            + "\"segment_536870929_level_0/index\":{\"length\":-2},"
            + "\"segment_536870929_level_0/index/_id\":{\"length\":-2},"
            + "\"segment_536870929_level_0/index/_id/attribute__id\":{\"length\":-2},"
            + "\"segment_536870929_level_0/index/_id/attribute__id/data\":{\"length\":80},"
            + "\"segment_536870929_level_0/index/_id/data\":{\"length\":120},"
            + "\"segment_536870929_level_0/index/_routing\":{\"length\":-2},"
            + "\"segment_536870929_level_0/index/_routing/dictionary\":{\"length\":8},"
            + "\"segment_536870929_level_0/index/_routing/index_format_option\":{\"length\":725},"
            + "\"segment_536870929_level_0/index/_routing/posting\":{\"length\":0},"
            + "\"segment_536870929_level_0/index/_seq_no\":{\"length\":-2},"
            + "\"segment_536870929_level_0/index/_seq_no/dictionary\":{\"length\":176},"
            + "\"segment_536870929_level_0/index/_seq_no/index_format_option\":{\"length\":725},"
            + "\"segment_536870929_level_0/index/_seq_no/posting\":{\"length\":0},"
            + "\"segment_536870929_level_0/index/foo_test\":{\"length\":-2},"
            + "\"segment_536870929_level_0/index/foo_test/dictionary\":{\"length\":8},"
            + "\"segment_536870929_level_0/index/foo_test/index_format_option\":{\"length\":725},"
            + "\"segment_536870929_level_0/index/foo_test/posting\":{\"length\":0},"
            + "\"segment_536870929_level_0/normal_tablet_virtual_attribute\":{\"length\":-2},"
            + "\"segment_536870929_level_0/normal_tablet_virtual_attribute/virtual_concurrent_idx_name"
            + "\":{\"length\":-2},\"segment_536870929_level_0/normal_tablet_virtual_attribute"
            + "/virtual_concurrent_idx_name/data\":{\"length\":40},"
            + "\"segment_536870929_level_0/normal_tablet_virtual_attribute/virtual_hash_id_field_name\":{\"length"
            + "\":-2},\"segment_536870929_level_0/normal_tablet_virtual_attribute/virtual_hash_id_field_name"
            + "/data\":{\"length\":20},\"segment_536870929_level_0/normal_tablet_virtual_attribute"
            + "/virtual_timestamp_field_name\":{\"length\":-2},"
            + "\"segment_536870929_level_0/normal_tablet_virtual_attribute/virtual_timestamp_field_name/data"
            + "\":{\"length\":80},\"segment_536870929_level_0/operation_log\":{\"length\":-2},"
            + "\"segment_536870929_level_0/operation_log/data\":{\"length\":179},"
            + "\"segment_536870929_level_0/operation_log/meta\":{\"length\":595},"
            + "\"segment_536870929_level_0/operation_log/operation_field_info.0\":{\"length\":302},"
            + "\"segment_536870929_level_0/segment_info\":{\"length\":363},"
            + "\"segment_536870929_level_0/segment_metrics\":{\"length\":109},"
            + "\"segment_536870929_level_0/summary\":{\"length\":-2},"
            + "\"segment_536870929_level_0/summary/data\":{\"length\":280},"
            + "\"segment_536870929_level_0/summary/offset\":{\"length\":80},"
            + "\"segment_536870930_level_0\":{\"length\":-2},"
            + "\"segment_536870930_level_0/attribute\":{\"length\":-2},"
            + "\"segment_536870930_level_0/attribute/_id\":{\"length\":-2},"
            + "\"segment_536870930_level_0/attribute/_id/data\":{\"length\":210},"
            + "\"segment_536870930_level_0/attribute/_id/data_info\":{\"length\":72},"
            + "\"segment_536870930_level_0/attribute/_id/offset\":{\"length\":44},"
            + "\"segment_536870930_level_0/attribute/_primary_term\":{\"length\":-2},"
            + "\"segment_536870930_level_0/attribute/_primary_term/data\":{\"length\":80},"
            + "\"segment_536870930_level_0/attribute/_seq_no\":{\"length\":-2},"
            + "\"segment_536870930_level_0/attribute/_seq_no/data\":{\"length\":80},"
            + "\"segment_536870930_level_0/attribute/_version\":{\"length\":-2},"
            + "\"segment_536870930_level_0/attribute/_version/data\":{\"length\":80},"
            + "\"segment_536870930_level_0/attribute/foo_test\":{\"length\":-2},"
            + "\"segment_536870930_level_0/attribute/foo_test/data\":{\"length\":10},"
            + "\"segment_536870930_level_0/attribute/foo_test/data_info\":{\"length\":71},"
            + "\"segment_536870930_level_0/attribute/foo_test/offset\":{\"length\":44},"
            + "\"segment_536870930_level_0/deletionmap\":{\"length\":-2},"
            + "\"segment_536870930_level_0/index\":{\"length\":-2},"
            + "\"segment_536870930_level_0/index/_id\":{\"length\":-2},"
            + "\"segment_536870930_level_0/index/_id/attribute__id\":{\"length\":-2},"
            + "\"segment_536870930_level_0/index/_id/attribute__id/data\":{\"length\":80},"
            + "\"segment_536870930_level_0/index/_id/data\":{\"length\":120},"
            + "\"segment_536870930_level_0/index/_routing\":{\"length\":-2},"
            + "\"segment_536870930_level_0/index/_routing/dictionary\":{\"length\":8},"
            + "\"segment_536870930_level_0/index/_routing/index_format_option\":{\"length\":725},"
            + "\"segment_536870930_level_0/index/_routing/posting\":{\"length\":0},"
            + "\"segment_536870930_level_0/index/_seq_no\":{\"length\":-2},"
            + "\"segment_536870930_level_0/index/_seq_no/dictionary\":{\"length\":176},"
            + "\"segment_536870930_level_0/index/_seq_no/index_format_option\":{\"length\":725},"
            + "\"segment_536870930_level_0/index/_seq_no/posting\":{\"length\":0},"
            + "\"segment_536870930_level_0/index/foo_test\":{\"length\":-2},"
            + "\"segment_536870930_level_0/index/foo_test/dictionary\":{\"length\":8},"
            + "\"segment_536870930_level_0/index/foo_test/index_format_option\":{\"length\":725},"
            + "\"segment_536870930_level_0/index/foo_test/posting\":{\"length\":0},"
            + "\"segment_536870930_level_0/normal_tablet_virtual_attribute\":{\"length\":-2},"
            + "\"segment_536870930_level_0/normal_tablet_virtual_attribute/virtual_concurrent_idx_name"
            + "\":{\"length\":-2},\"segment_536870930_level_0/normal_tablet_virtual_attribute"
            + "/virtual_concurrent_idx_name/data\":{\"length\":40},"
            + "\"segment_536870930_level_0/normal_tablet_virtual_attribute/virtual_hash_id_field_name\":{\"length"
            + "\":-2},\"segment_536870930_level_0/normal_tablet_virtual_attribute/virtual_hash_id_field_name"
            + "/data\":{\"length\":20},\"segment_536870930_level_0/normal_tablet_virtual_attribute"
            + "/virtual_timestamp_field_name\":{\"length\":-2},"
            + "\"segment_536870930_level_0/normal_tablet_virtual_attribute/virtual_timestamp_field_name/data"
            + "\":{\"length\":80},\"segment_536870930_level_0/operation_log\":{\"length\":-2},"
            + "\"segment_536870930_level_0/operation_log/data\":{\"length\":178},"
            + "\"segment_536870930_level_0/operation_log/meta\":{\"length\":595},"
            + "\"segment_536870930_level_0/operation_log/operation_field_info.0\":{\"length\":302},"
            + "\"segment_536870930_level_0/segment_info\":{\"length\":363},"
            + "\"segment_536870930_level_0/segment_metrics\":{\"length\":109},"
            + "\"segment_536870930_level_0/summary\":{\"length\":-2},"
            + "\"segment_536870930_level_0/summary/data\":{\"length\":280},"
            + "\"segment_536870930_level_0/summary/offset\":{\"length\":80},"
            + "\"segment_536870931_level_0\":{\"length\":-2},"
            + "\"segment_536870931_level_0/attribute\":{\"length\":-2},"
            + "\"segment_536870931_level_0/attribute/_id\":{\"length\":-2},"
            + "\"segment_536870931_level_0/attribute/_id/data\":{\"length\":210},"
            + "\"segment_536870931_level_0/attribute/_id/data_info\":{\"length\":72},"
            + "\"segment_536870931_level_0/attribute/_id/offset\":{\"length\":44},"
            + "\"segment_536870931_level_0/attribute/_primary_term\":{\"length\":-2},"
            + "\"segment_536870931_level_0/attribute/_primary_term/data\":{\"length\":80},"
            + "\"segment_536870931_level_0/attribute/_seq_no\":{\"length\":-2},"
            + "\"segment_536870931_level_0/attribute/_seq_no/data\":{\"length\":80},"
            + "\"segment_536870931_level_0/attribute/_version\":{\"length\":-2},"
            + "\"segment_536870931_level_0/attribute/_version/data\":{\"length\":80},"
            + "\"segment_536870931_level_0/attribute/foo_test\":{\"length\":-2},"
            + "\"segment_536870931_level_0/attribute/foo_test/data\":{\"length\":10},"
            + "\"segment_536870931_level_0/attribute/foo_test/data_info\":{\"length\":71},"
            + "\"segment_536870931_level_0/attribute/foo_test/offset\":{\"length\":44},"
            + "\"segment_536870931_level_0/deletionmap\":{\"length\":-2},"
            + "\"segment_536870931_level_0/index\":{\"length\":-2},"
            + "\"segment_536870931_level_0/index/_id\":{\"length\":-2},"
            + "\"segment_536870931_level_0/index/_id/attribute__id\":{\"length\":-2},"
            + "\"segment_536870931_level_0/index/_id/attribute__id/data\":{\"length\":80},"
            + "\"segment_536870931_level_0/index/_id/data\":{\"length\":120},"
            + "\"segment_536870931_level_0/index/_routing\":{\"length\":-2},"
            + "\"segment_536870931_level_0/index/_routing/dictionary\":{\"length\":8},"
            + "\"segment_536870931_level_0/index/_routing/index_format_option\":{\"length\":725},"
            + "\"segment_536870931_level_0/index/_routing/posting\":{\"length\":0},"
            + "\"segment_536870931_level_0/index/_seq_no\":{\"length\":-2},"
            + "\"segment_536870931_level_0/index/_seq_no/dictionary\":{\"length\":176},"
            + "\"segment_536870931_level_0/index/_seq_no/index_format_option\":{\"length\":725},"
            + "\"segment_536870931_level_0/index/_seq_no/posting\":{\"length\":0},"
            + "\"segment_536870931_level_0/index/foo_test\":{\"length\":-2},"
            + "\"segment_536870931_level_0/index/foo_test/dictionary\":{\"length\":8},"
            + "\"segment_536870931_level_0/index/foo_test/index_format_option\":{\"length\":725},"
            + "\"segment_536870931_level_0/index/foo_test/posting\":{\"length\":0},"
            + "\"segment_536870931_level_0/normal_tablet_virtual_attribute\":{\"length\":-2},"
            + "\"segment_536870931_level_0/normal_tablet_virtual_attribute/virtual_concurrent_idx_name"
            + "\":{\"length\":-2},\"segment_536870931_level_0/normal_tablet_virtual_attribute"
            + "/virtual_concurrent_idx_name/data\":{\"length\":40},"
            + "\"segment_536870931_level_0/normal_tablet_virtual_attribute/virtual_hash_id_field_name\":{\"length"
            + "\":-2},\"segment_536870931_level_0/normal_tablet_virtual_attribute/virtual_hash_id_field_name"
            + "/data\":{\"length\":20},\"segment_536870931_level_0/normal_tablet_virtual_attribute"
            + "/virtual_timestamp_field_name\":{\"length\":-2},"
            + "\"segment_536870931_level_0/normal_tablet_virtual_attribute/virtual_timestamp_field_name/data"
            + "\":{\"length\":80},\"segment_536870931_level_0/operation_log\":{\"length\":-2},"
            + "\"segment_536870931_level_0/operation_log/data\":{\"length\":175},"
            + "\"segment_536870931_level_0/operation_log/meta\":{\"length\":595},"
            + "\"segment_536870931_level_0/operation_log/operation_field_info.0\":{\"length\":302},"
            + "\"segment_536870931_level_0/segment_info\":{\"length\":363},"
            + "\"segment_536870931_level_0/segment_metrics\":{\"length\":109},"
            + "\"segment_536870931_level_0/summary\":{\"length\":-2},"
            + "\"segment_536870931_level_0/summary/data\":{\"length\":280},"
            + "\"segment_536870931_level_0/summary/offset\":{\"length\":80},"
            + "\"segment_536870932_level_0\":{\"length\":-2},"
            + "\"segment_536870932_level_0/attribute\":{\"length\":-2},"
            + "\"segment_536870932_level_0/attribute/_id\":{\"length\":-2},"
            + "\"segment_536870932_level_0/attribute/_id/data\":{\"length\":210},"
            + "\"segment_536870932_level_0/attribute/_id/data_info\":{\"length\":72},"
            + "\"segment_536870932_level_0/attribute/_id/offset\":{\"length\":44},"
            + "\"segment_536870932_level_0/attribute/_primary_term\":{\"length\":-2},"
            + "\"segment_536870932_level_0/attribute/_primary_term/data\":{\"length\":80},"
            + "\"segment_536870932_level_0/attribute/_seq_no\":{\"length\":-2},"
            + "\"segment_536870932_level_0/attribute/_seq_no/data\":{\"length\":80},"
            + "\"segment_536870932_level_0/attribute/_version\":{\"length\":-2},"
            + "\"segment_536870932_level_0/attribute/_version/data\":{\"length\":80},"
            + "\"segment_536870932_level_0/attribute/foo_test\":{\"length\":-2},"
            + "\"segment_536870932_level_0/attribute/foo_test/data\":{\"length\":10},"
            + "\"segment_536870932_level_0/attribute/foo_test/data_info\":{\"length\":71},"
            + "\"segment_536870932_level_0/attribute/foo_test/offset\":{\"length\":44},"
            + "\"segment_536870932_level_0/deletionmap\":{\"length\":-2},"
            + "\"segment_536870932_level_0/index\":{\"length\":-2},"
            + "\"segment_536870932_level_0/index/_id\":{\"length\":-2},"
            + "\"segment_536870932_level_0/index/_id/attribute__id\":{\"length\":-2},"
            + "\"segment_536870932_level_0/index/_id/attribute__id/data\":{\"length\":80},"
            + "\"segment_536870932_level_0/index/_id/data\":{\"length\":120},"
            + "\"segment_536870932_level_0/index/_routing\":{\"length\":-2},"
            + "\"segment_536870932_level_0/index/_routing/dictionary\":{\"length\":8},"
            + "\"segment_536870932_level_0/index/_routing/index_format_option\":{\"length\":725},"
            + "\"segment_536870932_level_0/index/_routing/posting\":{\"length\":0},"
            + "\"segment_536870932_level_0/index/_seq_no\":{\"length\":-2},"
            + "\"segment_536870932_level_0/index/_seq_no/dictionary\":{\"length\":176},"
            + "\"segment_536870932_level_0/index/_seq_no/index_format_option\":{\"length\":725},"
            + "\"segment_536870932_level_0/index/_seq_no/posting\":{\"length\":0},"
            + "\"segment_536870932_level_0/index/foo_test\":{\"length\":-2},"
            + "\"segment_536870932_level_0/index/foo_test/dictionary\":{\"length\":8},"
            + "\"segment_536870932_level_0/index/foo_test/index_format_option\":{\"length\":725},"
            + "\"segment_536870932_level_0/index/foo_test/posting\":{\"length\":0},"
            + "\"segment_536870932_level_0/normal_tablet_virtual_attribute\":{\"length\":-2},"
            + "\"segment_536870932_level_0/normal_tablet_virtual_attribute/virtual_concurrent_idx_name"
            + "\":{\"length\":-2},\"segment_536870932_level_0/normal_tablet_virtual_attribute"
            + "/virtual_concurrent_idx_name/data\":{\"length\":40},"
            + "\"segment_536870932_level_0/normal_tablet_virtual_attribute/virtual_hash_id_field_name\":{\"length"
            + "\":-2},\"segment_536870932_level_0/normal_tablet_virtual_attribute/virtual_hash_id_field_name"
            + "/data\":{\"length\":20},\"segment_536870932_level_0/normal_tablet_virtual_attribute"
            + "/virtual_timestamp_field_name\":{\"length\":-2},"
            + "\"segment_536870932_level_0/normal_tablet_virtual_attribute/virtual_timestamp_field_name/data"
            + "\":{\"length\":80},\"segment_536870932_level_0/operation_log\":{\"length\":-2},"
            + "\"segment_536870932_level_0/operation_log/data\":{\"length\":179},"
            + "\"segment_536870932_level_0/operation_log/meta\":{\"length\":595},"
            + "\"segment_536870932_level_0/operation_log/operation_field_info.0\":{\"length\":302},"
            + "\"segment_536870932_level_0/segment_info\":{\"length\":363},"
            + "\"segment_536870932_level_0/segment_metrics\":{\"length\":109},"
            + "\"segment_536870932_level_0/summary\":{\"length\":-2},"
            + "\"segment_536870932_level_0/summary/data\":{\"length\":280},"
            + "\"segment_536870932_level_0/summary/offset\":{\"length\":80},\"version"
            + ".536870933\":{\"length\":2397}},\"/usr/share/havenask/data_havenask/local_search_12000"
            + "/general_p0_r0/runtimedata/test_0/generation_0/partition_0_65535\":{\"index_format_version"
            + "\":{\"length\":82},\"index_partition_meta\":{\"length\":28},\"schema.json\":{\"length\":1171},"
            + "\"segment_0_level_0\":{\"length\":-2},\"segment_0_level_0/attribute\":{\"length\":-2},"
            + "\"segment_0_level_0/attribute/_id\":{\"length\":-2},"
            + "\"segment_0_level_0/attribute/_id/data\":{\"length\":1050},"
            + "\"segment_0_level_0/attribute/_id/data_info\":{\"length\":72},"
            + "\"segment_0_level_0/attribute/_id/offset\":{\"length\":204},"
            + "\"segment_0_level_0/attribute/_primary_term\":{\"length\":-2},"
            + "\"segment_0_level_0/attribute/_primary_term/data\":{\"length\":400},"
            + "\"segment_0_level_0/attribute/_seq_no\":{\"length\":-2},"
            + "\"segment_0_level_0/attribute/_seq_no/data\":{\"length\":400},"
            + "\"segment_0_level_0/attribute/_version\":{\"length\":-2},"
            + "\"segment_0_level_0/attribute/_version/data\":{\"length\":400},"
            + "\"segment_0_level_0/attribute/foo_test\":{\"length\":-2},"
            + "\"segment_0_level_0/attribute/foo_test/data\":{\"length\":50},"
            + "\"segment_0_level_0/attribute/foo_test/data_info\":{\"length\":71},"
            + "\"segment_0_level_0/attribute/foo_test/offset\":{\"length\":204},"
            + "\"segment_0_level_0/counter\":{\"length\":0},\"segment_0_level_0/deletionmap\":{\"length\":-2},"
            + "\"segment_0_level_0/index\":{\"length\":-2},\"segment_0_level_0/index/_id\":{\"length\":-2},"
            + "\"segment_0_level_0/index/_id/attribute__id\":{\"length\":-2},"
            + "\"segment_0_level_0/index/_id/attribute__id/data\":{\"length\":400},"
            + "\"segment_0_level_0/index/_id/data\":{\"length\":600},"
            + "\"segment_0_level_0/index/_routing\":{\"length\":-2},"
            + "\"segment_0_level_0/index/_routing/dictionary\":{\"length\":8},"
            + "\"segment_0_level_0/index/_routing/index_format_option\":{\"length\":725},"
            + "\"segment_0_level_0/index/_routing/posting\":{\"length\":0},"
            + "\"segment_0_level_0/index/_seq_no\":{\"length\":-2},"
            + "\"segment_0_level_0/index/_seq_no/dictionary\":{\"length\":816},"
            + "\"segment_0_level_0/index/_seq_no/index_format_option\":{\"length\":725},"
            + "\"segment_0_level_0/index/_seq_no/posting\":{\"length\":0},"
            + "\"segment_0_level_0/index/foo_test\":{\"length\":-2},"
            + "\"segment_0_level_0/index/foo_test/dictionary\":{\"length\":8},"
            + "\"segment_0_level_0/index/foo_test/index_format_option\":{\"length\":725},"
            + "\"segment_0_level_0/index/foo_test/posting\":{\"length\":0},"
            + "\"segment_0_level_0/segment_info\":{\"length\":362},"
            + "\"segment_0_level_0/segment_metrics\":{\"length\":52},"
            + "\"segment_0_level_0/summary\":{\"length\":-2},"
            + "\"segment_0_level_0/summary/data\":{\"length\":1400},"
            + "\"segment_0_level_0/summary/offset\":{\"length\":400},\"segment_1_level_0\":{\"length\":-2},"
            + "\"segment_1_level_0/attribute\":{\"length\":-2},"
            + "\"segment_1_level_0/attribute/_id\":{\"length\":-2},"
            + "\"segment_1_level_0/attribute/_id/data\":{\"length\":1260},"
            + "\"segment_1_level_0/attribute/_id/data_info\":{\"length\":72},"
            + "\"segment_1_level_0/attribute/_id/offset\":{\"length\":244},"
            + "\"segment_1_level_0/attribute/_primary_term\":{\"length\":-2},"
            + "\"segment_1_level_0/attribute/_primary_term/data\":{\"length\":480},"
            + "\"segment_1_level_0/attribute/_seq_no\":{\"length\":-2},"
            + "\"segment_1_level_0/attribute/_seq_no/data\":{\"length\":480},"
            + "\"segment_1_level_0/attribute/_version\":{\"length\":-2},"
            + "\"segment_1_level_0/attribute/_version/data\":{\"length\":480},"
            + "\"segment_1_level_0/attribute/foo_test\":{\"length\":-2},"
            + "\"segment_1_level_0/attribute/foo_test/data\":{\"length\":60},"
            + "\"segment_1_level_0/attribute/foo_test/data_info\":{\"length\":71},"
            + "\"segment_1_level_0/attribute/foo_test/offset\":{\"length\":244},"
            + "\"segment_1_level_0/counter\":{\"length\":0},\"segment_1_level_0/deletionmap\":{\"length\":-2},"
            + "\"segment_1_level_0/index\":{\"length\":-2},\"segment_1_level_0/index/_id\":{\"length\":-2},"
            + "\"segment_1_level_0/index/_id/attribute__id\":{\"length\":-2},"
            + "\"segment_1_level_0/index/_id/attribute__id/data\":{\"length\":480},"
            + "\"segment_1_level_0/index/_id/data\":{\"length\":720},"
            + "\"segment_1_level_0/index/_routing\":{\"length\":-2},"
            + "\"segment_1_level_0/index/_routing/dictionary\":{\"length\":8},"
            + "\"segment_1_level_0/index/_routing/index_format_option\":{\"length\":725},"
            + "\"segment_1_level_0/index/_routing/posting\":{\"length\":0},"
            + "\"segment_1_level_0/index/_seq_no\":{\"length\":-2},"
            + "\"segment_1_level_0/index/_seq_no/dictionary\":{\"length\":976},"
            + "\"segment_1_level_0/index/_seq_no/index_format_option\":{\"length\":725},"
            + "\"segment_1_level_0/index/_seq_no/posting\":{\"length\":0},"
            + "\"segment_1_level_0/index/foo_test\":{\"length\":-2},"
            + "\"segment_1_level_0/index/foo_test/dictionary\":{\"length\":8},"
            + "\"segment_1_level_0/index/foo_test/index_format_option\":{\"length\":725},"
            + "\"segment_1_level_0/index/foo_test/posting\":{\"length\":0},"
            + "\"segment_1_level_0/segment_info\":{\"length\":362},"
            + "\"segment_1_level_0/segment_metrics\":{\"length\":52},"
            + "\"segment_1_level_0/summary\":{\"length\":-2},"
            + "\"segment_1_level_0/summary/data\":{\"length\":1680},"
            + "\"segment_1_level_0/summary/offset\":{\"length\":480},\"segment_2_level_0\":{\"length\":-2},"
            + "\"segment_2_level_0/attribute\":{\"length\":-2},"
            + "\"segment_2_level_0/attribute/_id\":{\"length\":-2},"
            + "\"segment_2_level_0/attribute/_id/data\":{\"length\":840},"
            + "\"segment_2_level_0/attribute/_id/data_info\":{\"length\":72},"
            + "\"segment_2_level_0/attribute/_id/offset\":{\"length\":164},"
            + "\"segment_2_level_0/attribute/_primary_term\":{\"length\":-2},"
            + "\"segment_2_level_0/attribute/_primary_term/data\":{\"length\":320},"
            + "\"segment_2_level_0/attribute/_seq_no\":{\"length\":-2},"
            + "\"segment_2_level_0/attribute/_seq_no/data\":{\"length\":320},"
            + "\"segment_2_level_0/attribute/_version\":{\"length\":-2},"
            + "\"segment_2_level_0/attribute/_version/data\":{\"length\":320},"
            + "\"segment_2_level_0/attribute/foo_test\":{\"length\":-2},"
            + "\"segment_2_level_0/attribute/foo_test/data\":{\"length\":40},"
            + "\"segment_2_level_0/attribute/foo_test/data_info\":{\"length\":71},"
            + "\"segment_2_level_0/attribute/foo_test/offset\":{\"length\":164},"
            + "\"segment_2_level_0/counter\":{\"length\":0},\"segment_2_level_0/deletionmap\":{\"length\":-2},"
            + "\"segment_2_level_0/index\":{\"length\":-2},\"segment_2_level_0/index/_id\":{\"length\":-2},"
            + "\"segment_2_level_0/index/_id/attribute__id\":{\"length\":-2},"
            + "\"segment_2_level_0/index/_id/attribute__id/data\":{\"length\":320},"
            + "\"segment_2_level_0/index/_id/data\":{\"length\":480},"
            + "\"segment_2_level_0/index/_routing\":{\"length\":-2},"
            + "\"segment_2_level_0/index/_routing/dictionary\":{\"length\":8},"
            + "\"segment_2_level_0/index/_routing/index_format_option\":{\"length\":725},"
            + "\"segment_2_level_0/index/_routing/posting\":{\"length\":0},"
            + "\"segment_2_level_0/index/_seq_no\":{\"length\":-2},"
            + "\"segment_2_level_0/index/_seq_no/dictionary\":{\"length\":656},"
            + "\"segment_2_level_0/index/_seq_no/index_format_option\":{\"length\":725},"
            + "\"segment_2_level_0/index/_seq_no/posting\":{\"length\":0},"
            + "\"segment_2_level_0/index/foo_test\":{\"length\":-2},"
            + "\"segment_2_level_0/index/foo_test/dictionary\":{\"length\":8},"
            + "\"segment_2_level_0/index/foo_test/index_format_option\":{\"length\":725},"
            + "\"segment_2_level_0/index/foo_test/posting\":{\"length\":0},"
            + "\"segment_2_level_0/segment_info\":{\"length\":362},"
            + "\"segment_2_level_0/segment_metrics\":{\"length\":52},"
            + "\"segment_2_level_0/summary\":{\"length\":-2},"
            + "\"segment_2_level_0/summary/data\":{\"length\":1120},"
            + "\"segment_2_level_0/summary/offset\":{\"length\":320},\"segment_3_level_0\":{\"length\":-2},"
            + "\"segment_3_level_0/attribute\":{\"length\":-2},"
            + "\"segment_3_level_0/attribute/_id\":{\"length\":-2},"
            + "\"segment_3_level_0/attribute/_id/data\":{\"length\":210},"
            + "\"segment_3_level_0/attribute/_id/data_info\":{\"length\":72},"
            + "\"segment_3_level_0/attribute/_id/offset\":{\"length\":44},"
            + "\"segment_3_level_0/attribute/_primary_term\":{\"length\":-2},"
            + "\"segment_3_level_0/attribute/_primary_term/data\":{\"length\":80},"
            + "\"segment_3_level_0/attribute/_seq_no\":{\"length\":-2},"
            + "\"segment_3_level_0/attribute/_seq_no/data\":{\"length\":80},"
            + "\"segment_3_level_0/attribute/_version\":{\"length\":-2},"
            + "\"segment_3_level_0/attribute/_version/data\":{\"length\":80},"
            + "\"segment_3_level_0/attribute/foo_test\":{\"length\":-2},"
            + "\"segment_3_level_0/attribute/foo_test/data\":{\"length\":10},"
            + "\"segment_3_level_0/attribute/foo_test/data_info\":{\"length\":71},"
            + "\"segment_3_level_0/attribute/foo_test/offset\":{\"length\":44},"
            + "\"segment_3_level_0/counter\":{\"length\":0},\"segment_3_level_0/deletionmap\":{\"length\":-2},"
            + "\"segment_3_level_0/index\":{\"length\":-2},\"segment_3_level_0/index/_id\":{\"length\":-2},"
            + "\"segment_3_level_0/index/_id/attribute__id\":{\"length\":-2},"
            + "\"segment_3_level_0/index/_id/attribute__id/data\":{\"length\":80},"
            + "\"segment_3_level_0/index/_id/data\":{\"length\":120},"
            + "\"segment_3_level_0/index/_routing\":{\"length\":-2},"
            + "\"segment_3_level_0/index/_routing/dictionary\":{\"length\":8},"
            + "\"segment_3_level_0/index/_routing/index_format_option\":{\"length\":725},"
            + "\"segment_3_level_0/index/_routing/posting\":{\"length\":0},"
            + "\"segment_3_level_0/index/_seq_no\":{\"length\":-2},"
            + "\"segment_3_level_0/index/_seq_no/dictionary\":{\"length\":176},"
            + "\"segment_3_level_0/index/_seq_no/index_format_option\":{\"length\":725},"
            + "\"segment_3_level_0/index/_seq_no/posting\":{\"length\":0},"
            + "\"segment_3_level_0/index/foo_test\":{\"length\":-2},"
            + "\"segment_3_level_0/index/foo_test/dictionary\":{\"length\":8},"
            + "\"segment_3_level_0/index/foo_test/index_format_option\":{\"length\":725},"
            + "\"segment_3_level_0/index/foo_test/posting\":{\"length\":0},"
            + "\"segment_3_level_0/segment_info\":{\"length\":362},"
            + "\"segment_3_level_0/segment_metrics\":{\"length\":52},"
            + "\"segment_3_level_0/summary\":{\"length\":-2},"
            + "\"segment_3_level_0/summary/data\":{\"length\":280},"
            + "\"segment_3_level_0/summary/offset\":{\"length\":80},\"truncate_meta\":{\"length\":-2},"
            + "\"truncate_meta/index.mapper\":{\"length\":41}}},\"package_files\":{}}";
        EntryTable entryTable = EntryTable.parse(content);
        assertEquals(entryTable.toString(), content);
        assertEquals(entryTable.files.size(), 2);
        assertTrue(entryTable.files.containsKey(""));
    }
}
